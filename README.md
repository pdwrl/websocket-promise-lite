## What is it?

This is an Axios for WebSockets :-)

## For what?

To easily work with sockets in async / await style.

## Installation
```
npm i websocket-promise-lite
```

## How to use?
```javascript
import WebsocketPromiseLiteClient from 'websocket-promise-lite'

const demoFunc = async () => {
	const WS = new WebsocketPromiseLiteClient({
		url: 'wss://ws.postman-echo.com/raw'
	})
	await WS.connectionEstablished()
	const answer = await WS.send({
		myMessage: 'hello websocket!'
	})
	console.log(answer)

	// next actions ...

	WS.close()
}

demoFunc()
```
## Important!

Back-end (websocket server) have to answer with the same "messageId" parameter!

## API

### methods

- __connectionEstablished__: waits for the connection to be established. If fails it reconnects automatically
- __send__: sends any unserialized object by WS
- __close__: closes WS at normal way (code 1000)
- __destroy__: destructor. Removes all event listeners, closes WS connection and clears the list of operations

```javascript
const WS = new WebsocketPromiseLiteClient(config)
```
where __config__ is an object with a possible properties:

### Config parameters

__url__: WebSocket URL. Must start with "ws://" or "wss://". The only required param

__maxNumberOfReconnects__: maximum number of reconnections, after which there will be no more reconnections. If -1 then will be no reconnections. Default ```Infinity```.

__pauseBetweenReconnects__: pause between reconnections (in ms). If 0 then reconnections will become after randomized pause. Pauses are stored in array [xyz, 3xyz, 5xyz, 8xyz, 12xyz, 17xyz ... 17xyz], where xyz is random number. This is so that all clients reconnects at different time for stable back-end. Default ```0```.

__connectTimeout__: time in ms after which connection is considered unsuccessful (and then reconnects again). Default ```5000```.

__serializer__: serializer function. For example, ```CBOR.encode```. Default ```JSON.stringify```.

__deserializer__: deserializer function. For example, ```CBOR.decode```. Default ```JSON.parse```.

__binaryType__: type of data to be transmitted. In most cases it's "arraybuffer". But You may specify it as ```blob```. Default ```arraybuffer```.

__urlAdditionalGenerator__: use it when second url part have to be generated by some algorythm. Pass a function.

__onConnectionOpen__: function (async or not) which is called when a connection is opened successfully for a 1st time

__onConnectionClose__: function (async or not) which is called when a connection is closed.

__onConnectionReOpen__: function (async or not) which is called when a connection is before reopen.

__onBeforeReOpen__: function (async or not) which is called when a connection is before reopen.

__onNotPromisedData__: function (async or not) which is called when server sends not promised data (simple WS data from back-end)

## Tips

- Don't serialize data before sending via websocket-promise-lite. All the data is serialized by lib before sending.
- Library adds "messageId" field to object You are sending. Make sure Your data object has no field with the same name.
